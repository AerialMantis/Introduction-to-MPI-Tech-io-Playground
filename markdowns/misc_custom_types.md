## Custom types

As you might have noticed, all datatypes in MPI communications are atomic types : an element correspond to one singular value. Moreover, every sommunication force you to use a contiguous buffer with the same datatype. Sometimes, it might be more interesting to give additional information and meaning to the communications by creating higher-level structures. MPI allows us to do that in the form of **derived** or custom datatypes. To make our point, let's take a simple example :

Let's consider a system with $`N`$ processes where processes $`1`$ to $`N-1`$ are charged with generating data while process 0 centralizes and stores the data. The data generated by the processes corresponds to this struct :

```cpp
struct CustomData {
  int n_integers;
  int n_doubles;
  int* int_values;
  double* dbl_values;
};
```

This cannot be simply sent by a MPI call. If we wanted to send this kind of data structure with the knowledge we currently have and with $`N = 2`$, we would do it this way :

@[Naive version]({"stubs": ["misc_custom_types/types_example.cpp"], "command": "bash misc_custom_types/types_example.sh"})